{
  "hash": "5713802b3063c2c303be74a238d1b4cc",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Censored Data and Kaplan-Meier Curves\"\n# date: \"2025-02-10\"\ndate-modified: \"2025-02-27\"\nimage: thumbnail.png\n---\n\n\n\n::: callout-warning\n## Disclaimer\n\nThis article was written solely for informational and educational purposes, and does not constitute medical advice. If you have any health concerns, please consult a qualified medical professional.\n:::\n\nPatients and medical professionals are often interested in the probability that an event will or will not have occurred after a certain amount of time. For example, what is the probability that a burn will have healed after two weeks? What is the probability that someone's cancer will not have returned five years after they have gone into remission? To estimate these probabilities, researchers use a branch of statistics known as **survival analysis**.\n\n## Time to Event Data\n\nSurvival analysis is the study of **time to event data**. These are data that for each subject measure the time that elapses from a defined starting point -- for example, the diagnosis of a disease -- until a particular event happens -- for example, death. Despite the name, survival analysis does not presume that this event is death -- indeed, it could be a positive event, such as discharge from hospital. Though commonly used in medical statistics, survival analysis is not exclusive to epidemiology. It is also employed in fields as diverse as engineering and sociology, meaning it is sometimes known by other names, such as 'reliability analysis'[^1].\n\nOne of the central tasks of survival analysis is to estimate the **survival function**, $S(t)$, for the event of interest. This is a function of time equal to the probability that the event takes longer than the input time, $t$, to occur\n\n::: callout-note\n## Notation\n\n-   $T$ denotes a random variable representing the time until the event occurs.\n-   $t$ denotes a specific time duration.\n-   $S(t)=\\mathbb{P}(T>t)$ denotes the survival function.\n:::\n\nLet's consider a very simple scenario in which we might estimate a survival function. Suppose an electrical manufacturing company has a batch of faulty light bulbs, and they decide to pick ten of them at random to leave on and monitor for a week. They observe that:\n\n-   On the first day, three light bulbs fail.\n-   On the second day, four light bulbs fail.\n-   On the third day, no light bulbs fail\n-   On the fourth day, two light bulbs fail.\n-   On the fifth day, the final light bulb fails.\n\n![](light-bulbs.png)\n\nPutting aside the fact that this is a very small sample, it is relatively straightforward to estimate the survival function for these faulty light bulbs from this experiment. For example, to estimate $S(1)$, we just look at the proportion of light bulbs that last longer than one day -- seven tenths. By the [law of large numbers](https://en.wikipedia.org/wiki/Law_of_large_numbers), as we increase the number of light bulbs in the sample this proportion will eventually converge to the true probability of a faulty light bulb lasting longer than one day. We can do this calculation for each time marker, including the start point of the experiment -- we call this Day 0.\n\n\n\n```{=html}\n<div style=\"overflow-x:auto\">\n  <table class=\"table table-bordered table-sm\">\n    <caption>Estimated Faulty Light Bulb Survival Function</caption>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle; background-color: #006a90; color: white; width: 50%\">\n        Day\n        </td>\n        <td style=\"text-align: center; vertical-align: middle; background-color: #006a90; color: white\">\n        Survival Function Estimate\n        </td>\n    </tr>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle\">\n        0\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        <math>\n        <mn>1</mn>\n        </math>\n        </td>\n    </tr>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle\">\n        1\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        <math>\n        <mfrac>\n        <mn>7</mn>\n        <mn>10</mn>\n        </mfrac>\n        </math>\n        </td>\n    </tr>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle\">\n        2\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        <math>\n        <mfrac>\n        <mn>3</mn>\n        <mn>10</mn>\n        </mfrac>\n        </math>\n        </td>\n    </tr>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle\">\n        3\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        <math>\n        <mfrac>\n        <mn>3</mn>\n        <mn>10</mn>\n        </mfrac>\n        </math>\n        </td>\n    </tr>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle\">\n        4\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        <math>\n        <mfrac>\n        <mn>1</mn>\n        <mn>10</mn>\n        </mfrac>\n        </math>\n        </td>\n    </tr>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle\">\n        5\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        <math>\n        <mn>0</mn>\n        </math>\n        </td>\n    </tr>\n</table>\n</div>\n```\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Plotting the Estimated Survival Function in R\"}\ndays <- 0:5 # creating a vector of time markers\nsurvival_function <- c(1, 7/10, 3/10, 3/10, 1/10, 0) # creating a vector of estimated probabilities\npar(mar=c(bottom=4.2, left=5.1, top=1.8, right=0.9), family=\"Roboto Slab\") # setting the plot options\nplot(days, survival_function, type=\"s\", ylim=c(0,1), xlab=\"Day\", ylab=\"Estimated Survival Function\", col=\"#006a90\", lwd=4.8, cex.lab=1.8, cex.axis=1.8)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/estimated-light-bulb-survival-function-1.png){width=1152}\n:::\n:::\n\n\n\nEasy, right? Unfortunately, the time to event data we find in medical applications are rarely this straightforward to work with.\n\n## Censoring\n\nIn many medical studies producing time to event data, patients are recruited over a period of some time and then followed until a defined end date, at which point the investigators will want to analyse their outcomes. As a result of this, the event of interest may not have happened for all the subjects of the study. In survival analysis, these 'incomplete' data points are known as **censored data**. They do give us some information -- we know the event we are studying had not yet happened at the point at which censoring occurred. However, we cannot tell when, or indeed if, it would have gone on to happen.\n\nCensoring can also come about in other ways, including patients being lost to follow up, or experiencing a 'competing event'[^2]. For example, in a study of the time it took for catheter-associated complications to arise in children undergoing  peritoneal dialysis, observations were considered censored when a patient's catheter was removed before a complication had occurred[^3].\n\nCensored data make estimating a survival function considerably more complicated. Imagine, for example, that three of the light bulbs in our previous thought experiment accidentally got smashed at the end of the first day. \n\n![](light-bulbs-censored.png)\n\nWe could still approximate $S(1)$ to be seven tenths, since $$\\mathbb{P}(T>1)=1-\\mathbb{P}(T\\leq1),$$ which, since three light bulbs fail on the first day, we can estimate to be $$1-\\frac{3}{10}=\\frac{7}{10},$$ as in the original case. But what about $S(2)$ onwards? We don't know on which days the smashed light bulbs would have failed, so we can't estimate $S(t)$ for these values of $t$ in the same way.\n\n## The Kaplan-Meier Method\n\nIn 1958, Edward Kaplan and Paul Meier proposed an ingenious solution to the censoring problem[^4]. Their paper has gone on to become the most cited publication in the history of statistics[^5], and is seen as a seminal contribution to the field of survival analysis. Kaplan and Meier's central insight was that while censoring may stop us from directly estimating $\\mathbb{P}(T>t_i)$ for a particular value of time, $t_i$, it does not stop us from estimating $$\\mathbb{P}(T>t_i\\,|\\,T>t_{i-1}),$$ This is the conditional probability of an event taking longer than $t_i$ days, months, or years to occur, given that it has not already happened in $t_{i-1}$ days, months, or years.\n\n::: callout-note\n## Notation\n- $t_1,t_2,t_3\\ldots$, etc. denote the times to the event of interest in ascending order.\n- $t_{i-1}$ denotes the next lowest time to the event of interest to $t_i$.\n- $t_0$ denotes a time of $0$.\n:::\n\nThese conditional probabilities are quite easy to find, since \n\n$$\\begin{split}\n\\mathbb{P}(T>t_i\\,|\\,T>t_{i-1})&=1-\\mathbb{P}(T\\leq t_i\\,|\\,T>t_{i-1})\\\\&=1-\\mathbb{P}(T=t_i\\,|\\,T>t_{i-1}).\n\\end{split}$$\n\nwhich we can estimate by calculating the proportion of subjects remaining in the study (those who have not experienced censoring or the event of interest) after $t_{i-1}$ that do not have a time to event of $t_i$.\n\nIn our smashed light blub thought experiment, for example, we could estimate $\\mathbb{P}(T>2\\,|\\,T>1)$ to be two quarters (or one half). This is because on the first day three light bulbs fail and three light bulbs are censored, so four remain in the experiment on the second day, two of which survive\n\nKaplan and Meier realised that we can get from these conditional probabilities to the survival function using the [chain rule of conditional probabilities](https://en.wikipedia.org/wiki/Chain_rule_(probability)). For any $t_i$, we have that \n\n$$\n\\begin{split}\n\\mathbb{P}(T>t_i)\n&=\\mathbb{P}(T> t_i\\,|\\,T>t_{i-1})\\mathbb{P}(T>t_{i-1})\\\\\n&=\\mathbb{P}(T> t_i\\,|\\,T>t_{i-1})\\mathbb{P}(T>t_{i-1}\\,|\\,T>t_{i-2})\\mathbb{P}(T>t_{i-2})\\\\\n&=\\mathbb{P}(T> t_i\\,|\\,T>t_{i-1})\\mathbb{P}(T>t_{i-1}\\,|\\,T>t_{i-2})\\mathbb{P}(T>t_{i-2}\\,|\\,T>t_{i-3})\\mathbb{P}(T>t_{i-3})\\cdots\\\\\n&\\cdots\\mathbb{P}(T>t_2\\,|\\,T>t_1)\\mathbb{P}(T>t_2\\,|\\,T>t_1)\\mathbb{P}(T>t_1\\,|\\,T>t_0)\\mathbb{P}(T>t_0).\n\\end{split}\n$$\nWe know that $\\mathbb{P}(T>t_0)$, the probability of the time to the event of interest being more than zero, is one, since the event has not happened to any of our subjects at the start of the study. So by the expression above, we can recursively estimate the survival function $S(t_{i})$ for each $t_1,t_2,t_3,\\ldots$, using the cumulative product of the conditional probabilities $\\mathbb{P}(T> t_i\\,|\\,T>t_{i-1})$.\n\n## An Example With Real Data\n\nTo get an idea of how the Kaplan-Meier method of estimating a survival function works, let's try it out on some data from a real observational study from the 1980s[^6]. Over two years, a group of obstetricians in London recorded the time it took for a group of 38 women who had been experiencing fertility issues to conceive after a surgical intervention. The times to conception or censoring for each woman can be obtained from a 1998 article on the Kaplan-Meier method in the BMJ[^7].\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Inputting the Results of the Study into a Data Frame in R\"}\nwomen <- 1:38 # creating identifiers for each woman in the study\nevent_times <- c(1, 1, 11, 7, 3, 4, 9, 4, 24, 6, 9, 2, 6, 16, 9, 2, 2, 3, 1, 8, 8, 4, 4, 1, 7, 9, 2, 9, 24, \n                 1, 1, 9, 13, 10, 3, 2, 3, 2) # inputting the number of months after their surgical intervention\n                                              # at which they conceived or were censored\nconception_or_censoring <- c('Conceived', 'Conceived', 'Censored', 'Censored', 'Conceived', 'Conceived', 'Censored', 'Conceived', 'Censored', 'Conceived', 'Censored',\n                             'Conceived', 'Conceived', 'Conceived', 'Conceived', 'Censored', 'Conceived', 'Conceived', 'Conceived', 'Censored', 'Censored', 'Conceived',\n                             'Censored', 'Conceived', 'Censored', 'Conceived', 'Conceived', 'Conceived', 'Censored', 'Conceived', 'Conceived', 'Censored', 'Conceived',\n                             'Conceived', 'Conceived', 'Conceived', 'Censored', 'Conceived') # inputting which event occurred for each woman\nconception_study <- data.frame(subject=women, months=event_times, event=conception_or_censoring)\n```\n:::\n\n```{=html}\n<div style=\"overflow-x:auto\">\n  <table class=\"table table-bordered table-sm\">\n  <caption>Time to Event Data from a Study of Conception after Laparoscopy and Hydrotubation</caption>\n    <tr>\n        <td colspan=\"1\" rowspan=\"2\" style=\"background-color: #e4f8ff\"></td><td colspan=\"38\" style=\"text-align: left; vertical-align: middle; background-color: #006a90; color: white; padding-left: 0.75rem; padding-right: 0.75rem\">Study Participant</td>\n    </tr>\n    <tr>\n      <td style=\"text-align: center; vertical-align: middle; background-color: #009ed8; color: white\">1</td>\n      <td style=\"text-align: center; vertical-align: middle; background-color: #009ed8; color: white\">2</td>\n      <td style=\"text-align: center; vertical-align: middle; background-color: #009ed8; color: white\">3</td>\n      <td style=\"text-align: center; vertical-align: middle; background-color: #009ed8; color: white\">4</td>\n      <td style=\"text-align: center; vertical-align: middle; background-color: #009ed8; color: white\">5</td>\n      <td style=\"text-align: center; vertical-align: middle; background-color: #009ed8; color: white\">6</td>\n      <td style=\"text-align: center; vertical-align: middle; background-color: #009ed8; color: white\">7</td>\n      <td style=\"text-align: center; vertical-align: middle; background-color: #009ed8; color: white\">8</td>\n      <td style=\"text-align: center; vertical-align: middle; background-color: #009ed8; color: white\">9</td>\n      <td style=\"text-align: center; vertical-align: middle; background-color: #009ed8; color: white\">10</td>\n      <td style=\"text-align: center; vertical-align: middle; background-color: #009ed8; color: white\">11</td>\n      <td style=\"text-align: center; vertical-align: middle; background-color: #009ed8; color: white\">12</td>\n      <td style=\"text-align: center; vertical-align: middle; background-color: #009ed8; color: white\">13</td>\n      <td style=\"text-align: center; vertical-align: middle; background-color: #009ed8; color: white\">14</td>\n      <td style=\"text-align: center; vertical-align: middle; background-color: #009ed8; color: white\">15</td>\n      <td style=\"text-align: center; vertical-align: middle; background-color: #009ed8; color: white\">16</td>\n      <td style=\"text-align: center; vertical-align: middle; background-color: #009ed8; color: white\">17</td>\n      <td style=\"text-align: center; vertical-align: middle; background-color: #009ed8; color: white\">18</td>\n      <td style=\"text-align: center; vertical-align: middle; background-color: #009ed8; color: white\">19</td>\n      <td style=\"text-align: center; vertical-align: middle; background-color: #009ed8; color: white\">20</td>\n      <td style=\"text-align: center; vertical-align: middle; background-color: #009ed8; color: white\">21</td>\n      <td style=\"text-align: center; vertical-align: middle; background-color: #009ed8; color: white\">22</td>\n      <td style=\"text-align: center; vertical-align: middle; background-color: #009ed8; color: white\">23</td>\n      <td style=\"text-align: center; vertical-align: middle; background-color: #009ed8; color: white\">24</td>\n      <td style=\"text-align: center; vertical-align: middle; background-color: #009ed8; color: white\">25</td>\n      <td style=\"text-align: center; vertical-align: middle; background-color: #009ed8; color: white\">26</td>\n      <td style=\"text-align: center; vertical-align: middle; background-color: #009ed8; color: white\">27</td>\n      <td style=\"text-align: center; vertical-align: middle; background-color: #009ed8; color: white\">28</td>\n      <td style=\"text-align: center; vertical-align: middle; background-color: #009ed8; color: white\">29</td>\n      <td style=\"text-align: center; vertical-align: middle; background-color: #009ed8; color: white\">30</td>\n      <td style=\"text-align: center; vertical-align: middle; background-color: #009ed8; color: white\">31</td>\n      <td style=\"text-align: center; vertical-align: middle; background-color: #009ed8; color: white\">32</td>\n      <td style=\"text-align: center; vertical-align: middle; background-color: #009ed8; color: white\">33</td>\n      <td style=\"text-align: center; vertical-align: middle; background-color: #009ed8; color: white\">34</td>\n      <td style=\"text-align: center; vertical-align: middle; background-color: #009ed8; color: white\">35</td>\n      <td style=\"text-align: center; vertical-align: middle; background-color: #009ed8; color: white\">36</td>\n      <td style=\"text-align: center; vertical-align: middle; background-color: #009ed8; color: white\">37</td>\n      <td style=\"text-align: center; vertical-align: middle; background-color: #009ed8; color: white\">38</td>\n    </tr>\n    <tr>\n      <td style=\"text-align: left; vertical-align: middle; background-color: #006a90; color: white; padding-left: 0.75rem; padding-right: 0.75rem\">Event</td>\n        <td style=\"text-align: left; vertical-align: middle; padding-left: 0.75rem; padding-right: 0.75rem\">Conceived</td>\n        <td style=\"text-align: left; vertical-align: middle; padding-left: 0.75rem; padding-right: 0.75rem\">Conceived</td>\n        <td style=\"text-align: left; vertical-align: middle; padding-left: 0.75rem; padding-right: 0.75rem\">Censored</td>\n        <td style=\"text-align: left; vertical-align: middle; padding-left: 0.75rem; padding-right: 0.75rem\">Censored</td>\n        <td style=\"text-align: left; vertical-align: middle; padding-left: 0.75rem; padding-right: 0.75rem\">Conceived</td>\n        <td style=\"text-align: left; vertical-align: middle; padding-left: 0.75rem; padding-right: 0.75rem\">Conceived</td>\n        <td style=\"text-align: left; vertical-align: middle; padding-left: 0.75rem; padding-right: 0.75rem\">Censored</td>\n        <td style=\"text-align: left; vertical-align: middle; padding-left: 0.75rem; padding-right: 0.75rem\">Conceived</td>\n        <td style=\"text-align: left; vertical-align: middle; padding-left: 0.75rem; padding-right: 0.75rem\">Censored</td>\n        <td style=\"text-align: left; vertical-align: middle; padding-left: 0.75rem; padding-right: 0.75rem\">Conceived</td>\n        <td style=\"text-align: left; vertical-align: middle; padding-left: 0.75rem; padding-right: 0.75rem\">Censored</td>\n        <td style=\"text-align: left; vertical-align: middle; padding-left: 0.75rem; padding-right: 0.75rem\">Conceived</td>\n        <td style=\"text-align: left; vertical-align: middle; padding-left: 0.75rem; padding-right: 0.75rem\">Conceived</td>\n        <td style=\"text-align: left; vertical-align: middle; padding-left: 0.75rem; padding-right: 0.75rem\">Conceived</td>\n        <td style=\"text-align: left; vertical-align: middle; padding-left: 0.75rem; padding-right: 0.75rem\">Conceived</td>\n        <td style=\"text-align: left; vertical-align: middle; padding-left: 0.75rem; padding-right: 0.75rem\">Censored</td>\n        <td style=\"text-align: left; vertical-align: middle; padding-left: 0.75rem; padding-right: 0.75rem\">Conceived</td>\n        <td style=\"text-align: left; vertical-align: middle; padding-left: 0.75rem; padding-right: 0.75rem\">Conceived</td>\n        <td style=\"text-align: left; vertical-align: middle; padding-left: 0.75rem; padding-right: 0.75rem\">Conceived</td>\n        <td style=\"text-align: left; vertical-align: middle; padding-left: 0.75rem; padding-right: 0.75rem\">Censored</td>\n        <td style=\"text-align: left; vertical-align: middle; padding-left: 0.75rem; padding-right: 0.75rem\">Censored</td>\n        <td style=\"text-align: left; vertical-align: middle; padding-left: 0.75rem; padding-right: 0.75rem\">Conceived</td>\n        <td style=\"text-align: left; vertical-align: middle; padding-left: 0.75rem; padding-right: 0.75rem\">Censored</td>\n        <td style=\"text-align: left; vertical-align: middle; padding-left: 0.75rem; padding-right: 0.75rem\">Conceived</td>\n        <td style=\"text-align: left; vertical-align: middle; padding-left: 0.75rem; padding-right: 0.75rem\">Censored</td>\n        <td style=\"text-align: left; vertical-align: middle; padding-left: 0.75rem; padding-right: 0.75rem\">Conceived</td>\n        <td style=\"text-align: left; vertical-align: middle; padding-left: 0.75rem; padding-right: 0.75rem\">Conceived</td>\n        <td style=\"text-align: left; vertical-align: middle; padding-left: 0.75rem; padding-right: 0.75rem\">Conceived</td>\n        <td style=\"text-align: left; vertical-align: middle; padding-left: 0.75rem; padding-right: 0.75rem\">Censored</td>\n        <td style=\"text-align: left; vertical-align: middle; padding-left: 0.75rem; padding-right: 0.75rem\">Conceived</td>\n        <td style=\"text-align: left; vertical-align: middle; padding-left: 0.75rem; padding-right: 0.75rem\">Conceived</td>\n        <td style=\"text-align: left; vertical-align: middle; padding-left: 0.75rem; padding-right: 0.75rem\">Censored</td>\n        <td style=\"text-align: left; vertical-align: middle; padding-left: 0.75rem; padding-right: 0.75rem\">Conceived</td>\n        <td style=\"text-align: left; vertical-align: middle; padding-left: 0.75rem; padding-right: 0.75rem\">Conceived</td>\n        <td style=\"text-align: left; vertical-align: middle; padding-left: 0.75rem; padding-right: 0.75rem\">Conceived</td>\n        <td style=\"text-align: left; vertical-align: middle; padding-left: 0.75rem; padding-right: 0.75rem\">Conceived</td>\n        <td style=\"text-align: left; vertical-align: middle; padding-left: 0.75rem; padding-right: 0.75rem\">Censored</td>\n        <td style=\"text-align: left; vertical-align: middle; padding-left: 0.75rem; padding-right: 0.75rem\">Conceived</td>\n    </tr>\n    <tr>\n      <td style=\"text-align: left; vertical-align: middle; background-color: #006a90; color: white; padding-left: 0.75rem; padding-right: 0.75rem\">Months Until Event</td>\n        <td style=\"text-align: center; vertical-align: middle\">1</td>\n        <td style=\"text-align: center; vertical-align: middle\">1</td>\n        <td style=\"text-align: center; vertical-align: middle\">11</td>\n        <td style=\"text-align: center; vertical-align: middle\">7</td>\n        <td style=\"text-align: center; vertical-align: middle\">3</td>\n        <td style=\"text-align: center; vertical-align: middle\">4</td>\n        <td style=\"text-align: center; vertical-align: middle\">9</td>\n        <td style=\"text-align: center; vertical-align: middle\">4</td>\n        <td style=\"text-align: center; vertical-align: middle\">24</td>\n        <td style=\"text-align: center; vertical-align: middle\">6</td>\n        <td style=\"text-align: center; vertical-align: middle\">9</td>\n        <td style=\"text-align: center; vertical-align: middle\">2</td>\n        <td style=\"text-align: center; vertical-align: middle\">6</td>\n        <td style=\"text-align: center; vertical-align: middle\">16</td>\n        <td style=\"text-align: center; vertical-align: middle\">9</td>\n        <td style=\"text-align: center; vertical-align: middle\">2</td>\n        <td style=\"text-align: center; vertical-align: middle\">2</td>\n        <td style=\"text-align: center; vertical-align: middle\">3</td>\n        <td style=\"text-align: center; vertical-align: middle\">1</td>\n        <td style=\"text-align: center; vertical-align: middle\">8</td>\n        <td style=\"text-align: center; vertical-align: middle\">8</td>\n        <td style=\"text-align: center; vertical-align: middle\">4</td>\n        <td style=\"text-align: center; vertical-align: middle\">4</td>\n        <td style=\"text-align: center; vertical-align: middle\">1</td>\n        <td style=\"text-align: center; vertical-align: middle\">7</td>\n        <td style=\"text-align: center; vertical-align: middle\">9</td>\n        <td style=\"text-align: center; vertical-align: middle\">2</td>\n        <td style=\"text-align: center; vertical-align: middle\">9</td>\n        <td style=\"text-align: center; vertical-align: middle\">24</td>\n        <td style=\"text-align: center; vertical-align: middle\">1</td>\n        <td style=\"text-align: center; vertical-align: middle\">1</td>\n        <td style=\"text-align: center; vertical-align: middle\">9</td>\n        <td style=\"text-align: center; vertical-align: middle\">13</td>\n        <td style=\"text-align: center; vertical-align: middle\">10</td>\n        <td style=\"text-align: center; vertical-align: middle\">3</td>\n        <td style=\"text-align: center; vertical-align: middle\">2</td>\n        <td style=\"text-align: center; vertical-align: middle\">3</td>\n        <td style=\"text-align: center; vertical-align: middle\">2</td>\n    </tr>\n</table>\n</div>\n```\n\n\n\nTo make it easier to do our survival analysis, let's summarise this data so that we can easily see the number of women who conceived or were censored at each distinct time step.\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Restructuring the Data in R\"}\nmonths_from_intervention <- sort(unique(conception_study$months)) # getting the different numbers of months after surgical intervention \n                                                                  # it took for conception or censoring to occur\nmonths_from_intervention <- c(0, months_from_intervention) # adding month zero for the start of the study\nnum_times <- length(months_from_intervention) # finding the number of unique event times \nconception_data_summary <- data.frame(months=months_from_intervention, \n                                      censored=rep(NA, times=num_times), \n                                      conceived=rep(NA, times=num_times))\nfor (i in 1:num_times) { # counting the number of conceptions and censorings at each event time\n  month_i <- months_from_intervention[i]\n  conception_data_summary$censored[i] <- nrow(conception_study[conception_study$months == month_i & conception_study$event == 'Censored', ])\n  conception_data_summary$conceived[i] <- nrow(conception_study[conception_study$months == month_i & conception_study$event == 'Conceived', ])\n}\n```\n:::\n\n```{=html}\n<div style=\"overflow-x:auto\">\n  <table class=\"table table-bordered table-sm\">\n    <caption>Summarised Conception Study Data</caption>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle; background-color: #006a90; color: white\">\n        <div style=\"white-space: nowrap\">Months from</div>\n        <div style=\"white-space: nowrap\">Intervention</div>\n        </td>\n        <td style=\"text-align: center; vertical-align: middle; background-color: #006a90; color: white\">\n        <div style=\"white-space: nowrap\">Number of</div>\n        <div style=\"white-space: nowrap\">Censorings</div>\n        </td>\n        <td style=\"text-align: center; vertical-align: middle; background-color: #006a90; color: white\">\n        <div style=\"white-space: nowrap\">Number of</div>\n        <div style=\"white-space: nowrap\">Conceptions</div>\n        </td>\n    </tr>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle\">\n        0\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        0\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        0\n        </td>\n    </tr>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle\">\n        1\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        0\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        6\n        </td>\n    </tr>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle\">\n        2\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        1\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        5\n        </td>\n    </tr>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle\">\n        3\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        1\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        3\n        </td>\n    </tr>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle\">\n        4\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        1\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        3\n        </td>\n    </tr>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle\">\n        6\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        0\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        2\n        </td>\n    </tr>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle\">\n        7\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        2\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        0\n        </td>\n    </tr>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle\">\n        8\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        2\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        0\n        </td>\n    </tr>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle\">\n        9\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        3\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        3\n        </td>\n    </tr>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle\">\n        10\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        0\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        1\n        </td>\n    </tr>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle\">\n        11\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        1\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        0\n        </td>\n    </tr>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle\">\n        13\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        0\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        1\n        </td>\n    </tr>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle\">\n        16\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        0\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        1\n        </td>\n    </tr>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle\">\n        24\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        2\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        0\n        </td>\n    </tr>\n</table>\n</div>\n```\n\n\n\nTo calculate the conditional probability $\\mathbb{P}(T>t_i|T>t_{i-1})$ for each observed number of months from conception, $t_i$, we first need to find out how many women were still being followed up at each stage. \n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Finding the Number of Study Participants Still Being Followed Up at Each Time Stage in R\"}\nconception_data_summary$remaining <- rep(NA, times=num_times) # initialising a column of our data frame to store the number of remaining study members at each event time\nconception_data_summary$remaining[1] <- 38 # at month zero, all women are still being followed up \nfor (i in 2:num_times) { # finding the number of women still being followed up at each event time from the previous number, \n                         # and the number who conceived or were censored at the previous event time\n  prev_conceptions <- conception_data_summary$conceived[i-1]\n  prev_censorings <- conception_data_summary$censored[i-1]\n  conception_data_summary$remaining[i] <- conception_data_summary$remaining[i-1] - prev_conceptions - prev_censorings \n}\n```\n:::\n\n```{=html}\n<div style=\"overflow-x:auto\">\n  <table class=\"table table-bordered table-sm\">\n    <caption>Summarised Conception Study Data (Including Numbers of Participants Remaining in Follow Up)</caption>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle; background-color: #006a90; color: white\">\n        <div style=\"white-space: nowrap\">Months from</div>\n        <div style=\"white-space: nowrap\">Intervention</div>\n        </td>\n        <td style=\"text-align: center; vertical-align: middle; background-color: #006a90; color: white\">\n        <div style=\"white-space: nowrap\">Number of</div>\n        <div style=\"white-space: nowrap\">Censorings</div>\n        </td>\n        <td style=\"text-align: center; vertical-align: middle; background-color: #006a90; color: white\">\n        <div style=\"white-space: nowrap\">Number of</div>\n        <div style=\"white-space: nowrap\">Conceptions</div>\n        </td>\n        <td style=\"text-align: center; vertical-align: middle; background-color: #006a90; color: white\">\n        <div style=\"white-space: nowrap\">Number of Participants</div>\n        <div style=\"white-space: nowrap\">Still Being Followed</div>\n        </td>\n    </tr>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle\">\n        0\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        0\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        0\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        38 \n        </td>\n    </tr>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle\">\n        1\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        0\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        6\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        38 &minus; 0 &minus; 0 = 38\n        </td>\n    </tr>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle\">\n        2\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        1\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        5\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        38 &minus; 0 &minus; 6 = 32\n        </td>\n    </tr>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle\">\n        3\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        1\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        3\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        32 &minus; 1 &minus; 5 = 26\n        </td>\n    </tr>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle\">\n        4\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        1\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        3\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        26 &minus; 1 &minus; 3 = 22\n        </td>\n    </tr>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle\">\n        6\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        0\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        2\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        22 &minus; 1 &minus; 3 = 18\n        </td>\n    </tr>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle\">\n        7\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        2\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        0\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        18 &minus; 0 &minus; 2 = 16\n        </td>\n    </tr>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle\">\n        8\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        2\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        0\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        16 &minus; 2 &minus; 0 = 14\n        </td>\n    </tr>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle\">\n        9\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        3\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        3\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        14 &minus; 2 &minus; 0 = 12\n        </td>\n    </tr>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle\">\n        10\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        0\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        1\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        12 &minus; 3 &minus; 3 = 6\n        </td>\n    </tr>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle\">\n        11\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        1\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        0\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        6 &minus; 0 &minus; 1 = 5\n        </td>\n    </tr>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle\">\n        13\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        0\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        1\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        5 &minus; 1 &minus; 0 = 4\n        </td>\n    </tr>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle\">\n        16\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        0\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        1\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        4 &minus; 0 &minus; 1 = 3\n        </td>\n    </tr>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle\">\n        24\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        2\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        0\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        3 &minus; 0 &minus; 1 = 2\n        </td>\n    </tr>\n</table>\n</div>\n```\n\n\n\nNow we can start our survival analysis properly by estimating $\\mathbb{P}(T>t_i\\,|\\,T>t_{i-1})$ for each $t_i$. We have gleaned all the information we need from the number of censorings at each time stage, so this column can be removed.\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Estimating the Conditional Probabilities for Each Time Stage in R\"}\nconception_survival_analysis <- subset(conception_data_summary, select=-censored) # creating a new data frame without the censoring column\nconception_survival_analysis$conditionals <- with(conception_survival_analysis, (remaining-conceived)/remaining)\n```\n:::\n\n```{=html}\n<div style=\"overflow-x:auto\">\n  <table class=\"table table-bordered table-sm\">\n    <caption>Conception Study Data With Estimated Conditional Probabilities</caption>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle; background-color: #006a90; color: white\">\n        <math>\n        <mi>i</mi>\n        </math>\n        </td>\n        <td style=\"text-align: center; vertical-align: middle; background-color: #006a90; color: white\">\n        <math>\n        <msub>\n        <mi>t</mi>\n        <mi>i</mi>\n        </msub>\n        </math>\n        <br>\n        (Months)\n        </td>\n        <td style=\"text-align: center; vertical-align: middle; background-color: #006a90; color: white\">\n        <math>\n        <mi mathvariant=\"normal\">#</mi>\n        <mo stretchy=\"false\">(</mo>\n        <mi>T</mi>\n        <mo>=</mo>\n        <msub>\n        <mi>t</mi>\n        <mi>i</mi>\n        </msub>\n        <mo stretchy=\"false\">)</mo>\n        </math>\n        (Conceptions)\n        </td>\n        <td style=\"text-align: center; vertical-align: middle; background-color: #006a90; color: white\">\n        <div style=\"white-space: nowrap\">Number of Study</div>\n        <div style=\"white-space: nowrap\">Participants</div>\n        </td>\n        <td style=\"text-align: center; vertical-align: middle; background-color: #006a90; color: white\">\n        Estimated<br>\n        <math>\n          <mrow data-mjx-texclass=\"ORD\">\n            <mi mathvariant=\"double-struck\">P</mi>\n          </mrow>\n          <mo stretchy=\"false\">(</mo>\n          <mi>T</mi>\n          <mo>&gt;</mo>\n          <msub>\n            <mi>t</mi>\n            <mi>i</mi>\n          </msub>\n          <mstyle scriptlevel=\"0\">\n            <mspace width=\"0.167em\"></mspace>\n          </mstyle>\n          <mo data-mjx-texclass=\"ORD\" stretchy=\"false\">|</mo>\n          <mstyle scriptlevel=\"0\">\n            <mspace width=\"0.167em\"></mspace>\n          </mstyle>\n          <mi>T</mi>\n          <mo>&gt;</mo>\n          <msub>\n            <mi>t</mi>\n            <mrow data-mjx-texclass=\"ORD\">\n              <mi>i</mi>\n              <mo>&#x2212;</mo>\n              <mn>1</mn>\n            </mrow>\n          </msub>\n          <mo stretchy=\"false\">)</mo>\n        </math>\n        </td>\n    </tr>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle\">\n        0\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        0\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        0\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        38 \n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        <math>\n          <mtext>N/A</mtext>\n          <mstyle scriptlevel=\"0\">\n            <mspace width=\"0.167em\"></mspace>\n          </mstyle>\n          <mo stretchy=\"false\">(</mo>\n          <mrow data-mjx-texclass=\"ORD\">\n            <mi mathvariant=\"double-struck\">P</mi>\n          </mrow>\n          <mo stretchy=\"false\">(</mo>\n          <mi>T</mi>\n          <mo>&gt;</mo>\n          <mn>0</mn>\n          <mo stretchy=\"false\">)</mo>\n          <mo>=</mo>\n          <mn>1</mn>\n          <mo stretchy=\"false\">)</mo>\n        </math>\n        </td>\n    </tr>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle\">\n        1\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        1\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        6\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        38\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        <math>\n          <mn>1</mn>\n          <mo>&#x2212;</mo>\n          <mfrac>\n            <mn>6</mn>\n            <mn>38</mn>\n          </mfrac>\n          <mo>=</mo>\n          <mfrac>\n            <mn>32</mn>\n            <mn>38</mn>\n          </mfrac>\n          <mo>&#x2248;</mo>\n          <mn>0.84</mn>\n        </math>\n        </td>\n    </tr>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle\">\n        2\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        2\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        5\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        32\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        <math>\n          <mn>1</mn>\n          <mo>&#x2212;</mo>\n          <mfrac>\n            <mn>5</mn>\n            <mn>32</mn>\n          </mfrac>\n          <mo>=</mo>\n          <mfrac>\n            <mn>27</mn>\n            <mn>32</mn>\n          </mfrac>\n          <mo>&#x2248;</mo>\n          <mn>0.84</mn>\n        </math>\n        </td>\n    </tr>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle\">\n        3\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        3\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        3\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        26\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        <math>\n          <mn>1</mn>\n          <mo>&#x2212;</mo>\n          <mfrac>\n            <mn>3</mn>\n            <mn>26</mn>\n          </mfrac>\n          <mo>=</mo>\n          <mfrac>\n            <mn>23</mn>\n            <mn>26</mn>\n          </mfrac>\n          <mo>&#x2248;</mo>\n          <mn>0.88</mn>\n        </math>\n        </td>\n    </tr>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle\">\n        4\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        4\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        3\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        22\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        <math>\n          <mn>1</mn>\n          <mo>&#x2212;</mo>\n          <mfrac>\n            <mn>3</mn>\n            <mn>22</mn>\n          </mfrac>\n          <mo>=</mo>\n          <mfrac>\n            <mn>19</mn>\n            <mn>22</mn>\n          </mfrac>\n          <mo>&#x2248;</mo>\n          <mn>0.86</mn>\n        </math>\n        </td>\n    </tr>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle\">\n        5\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        6\n        <td style=\"text-align: center; vertical-align: middle\">\n        2\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        18\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        <math>\n          <mn>1</mn>\n          <mo>&#x2212;</mo>\n          <mfrac>\n            <mn>2</mn>\n            <mn>18</mn>\n          </mfrac>\n          <mo>=</mo>\n          <mfrac>\n            <mn>16</mn>\n            <mn>18</mn>\n          </mfrac>\n          <mo>&#x2248;</mo>\n          <mn>0.89</mn>\n        </math>\n        </td>\n    </tr>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle\">\n        6\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        7\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        0\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        16\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        <math>\n          <mn>1</mn>\n          <mo>&#x2212;</mo>\n          <mfrac>\n            <mn>0</mn>\n            <mn>16</mn>\n          </mfrac>\n          <mo>=</mo>\n          <mn>1</mn>\n        </math>\n        </td>\n    </tr>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle\">\n        7\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        8\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        0\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        14\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        <math>\n          <mn>1</mn>\n          <mo>&#x2212;</mo>\n          <mfrac>\n            <mn>0</mn>\n            <mn>14</mn>\n          </mfrac>\n          <mo>=</mo>\n          <mn>1</mn>\n        </math>\n        </td>\n    </tr>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle\">\n        8\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        9\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        3\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        12\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        <math>\n          <mn>1</mn>\n          <mo>&#x2212;</mo>\n          <mfrac>\n            <mn>3</mn>\n            <mn>12</mn>\n          </mfrac>\n          <mo>=</mo>\n          <mfrac>\n            <mn>9</mn>\n            <mn>12</mn>\n          </mfrac>\n          <mo>=</mo>\n          <mn>0.75</mn>\n        </math>\n        </td>\n    </tr>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle\">\n        9\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        10\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        1\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        6\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        <math>\n          <mn>1</mn>\n          <mo>&#x2212;</mo>\n          <mfrac>\n            <mn>1</mn>\n            <mn>6</mn>\n          </mfrac>\n          <mo>=</mo>\n          <mfrac>\n            <mn>5</mn>\n            <mn>6</mn>\n          </mfrac>\n          <mo>&#x2248;</mo>\n          <mn>0.83</mn>\n        </math>\n        </td>\n    </tr>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle\">\n        10\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        11\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        0\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        5\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        <math>\n          <mn>1</mn>\n          <mo>&#x2212;</mo>\n          <mfrac>\n            <mn>0</mn>\n            <mn>5</mn>\n          </mfrac>\n          <mo>=</mo>\n          <mn>1</mn>\n        </math>\n        </td>\n    </tr>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle\">\n        11\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        13\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        1\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        4\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        <math>\n          <mn>1</mn>\n          <mo>&#x2212;</mo>\n          <mfrac>\n            <mn>1</mn>\n            <mn>4</mn>\n          </mfrac>\n          <mo>=</mo>\n          <mfrac>\n            <mn>3</mn>\n            <mn>4</mn>\n          </mfrac>\n          <mo>=</mo>\n          <mn>0.75</mn>\n        </math>\n        </td>\n    </tr>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle\">\n        12\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        16\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        1\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        3\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        <math>\n          <mn>1</mn>\n          <mo>&#x2212;</mo>\n          <mfrac>\n            <mn>1</mn>\n            <mn>3</mn>\n          </mfrac>\n          <mo>=</mo>\n          <mfrac>\n            <mn>2</mn>\n            <mn>3</mn>\n          </mfrac>\n          <mo>&#x2248;</mo>\n          <mn>0.67</mn>\n        </math>\n        </td>\n    </tr>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle\">\n        13\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        24\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        0\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        2\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        <math>\n          <mn>1</mn>\n          <mo>&#x2212;</mo>\n          <mfrac>\n            <mn>0</mn>\n            <mn>2</mn>\n          </mfrac>\n          <mo>=</mo>\n          <mn>1</mn>\n        </math>\n        </td>\n    </tr>\n</table>\n</div>\n```\n\n\n\nFinally, we can use these conditional probabilities to estimate $S(t)$.\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Estimating the Survival Function in R\"}\nconception_survival_analysis$survival <- cumprod(conception_survival_analysis$conditionals) # finding the cumulative product of the estimated conditional probabilities\n```\n:::\n\n```{=html}\n<div style=\"overflow-x:auto\">\n  <table class=\"table table-bordered table-sm\">\n    <caption>Survival Analysis of Time to Event Data from a Study of Conception after Laparoscopy and Hydrotubation</caption>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle; background-color: #006a90; color: white\">\n        <math>\n        <mi>i</mi>\n        </math>\n        </td>\n        <td style=\"text-align: center; vertical-align: middle; background-color: #006a90; color: white\">\n        <math>\n        <msub>\n        <mi>t</mi>\n        <mi>i</mi>\n        </msub>\n        </math>\n        <br>(Months)\n        </td>\n        <td style=\"text-align: center; vertical-align: middle; background-color: #006a90; color: white\">\n        <math>\n        <mi mathvariant=\"normal\">#</mi>\n        <mo stretchy=\"false\">(</mo>\n        <mi>T</mi>\n        <mo>=</mo>\n        <msub>\n        <mi>t</mi>\n        <mi>i</mi>\n        </msub>\n        <mo stretchy=\"false\">)</mo>\n        </math>\n        (Conceptions)\n        </td>\n        <td style=\"text-align: center; vertical-align: middle; background-color: #006a90; color: white\">\n        <div style=\"white-space: nowrap\">Number of Study</div>\n        <div style=\"white-space: nowrap\">Participants</div>\n        </td>\n        <td style=\"text-align: center; vertical-align: middle; background-color: #006a90; color: white\">\n        Estimated\n        <math>\n          <mrow data-mjx-texclass=\"ORD\">\n            <mi mathvariant=\"double-struck\">P</mi>\n          </mrow>\n          <mo stretchy=\"false\">(</mo>\n          <mi>T</mi>\n          <mo>&gt;</mo>\n          <msub>\n            <mi>t</mi>\n            <mi>i</mi>\n          </msub>\n          <mstyle scriptlevel=\"0\">\n            <mspace width=\"0.167em\"></mspace>\n          </mstyle>\n          <mo data-mjx-texclass=\"ORD\" stretchy=\"false\">|</mo>\n          <mstyle scriptlevel=\"0\">\n            <mspace width=\"0.167em\"></mspace>\n          </mstyle>\n          <mi>T</mi>\n          <mo>&gt;</mo>\n          <msub>\n            <mi>t</mi>\n            <mrow data-mjx-texclass=\"ORD\">\n              <mi>i</mi>\n              <mo>&#x2212;</mo>\n              <mn>1</mn>\n            </mrow>\n          </msub>\n          <mo stretchy=\"false\">)</mo>\n        </math>\n        </td>\n        <td style=\"text-align: center; vertical-align: middle; background-color: #006a90; color: white\">\n        Estimated<br>\n        <math>\n          <mrow data-mjx-texclass=\"ORD\">\n            <mi mathvariant=\"double-struck\">P</mi>\n          </mrow>\n          <mo stretchy=\"false\">(</mo>\n          <mi>T</mi>\n          <mo>&gt;</mo>\n          <msub>\n            <mi>t</mi>\n            <mi>i</mi>\n          </msub>\n          <mo stretchy=\"false\">)</mo>\n        </math>\n        </td>\n    </tr>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle\">\n        0\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        0\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        0\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        38 \n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        <math>\n          <mtext>N/A</mtext>\n          <mstyle scriptlevel=\"0\">\n            <mspace width=\"0.167em\"></mspace>\n          </mstyle>\n          <mo stretchy=\"false\">(</mo>\n          <mrow data-mjx-texclass=\"ORD\">\n            <mi mathvariant=\"double-struck\">P</mi>\n          </mrow>\n          <mo stretchy=\"false\">(</mo>\n          <mi>T</mi>\n          <mo>&gt;</mo>\n          <mn>0</mn>\n          <mo stretchy=\"false\">)</mo>\n          <mo>=</mo>\n          <mn>1</mn>\n          <mo stretchy=\"false\">)</mo>\n        </math>\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        <math>\n          <mn>1</mn>\n        </math>\n        </td>\n    </tr>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle\">\n        1\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        1\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        6\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        38\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        <math>\n          <mfrac>\n            <mn>32</mn>\n            <mn>38</mn>\n          </mfrac>\n        </math>\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        <math>\n          <mfrac>\n            <mn>32</mn>\n            <mn>38</mn>\n          </mfrac>\n          <mo>&#xD7;</mo>\n          <mn>1</mn>\n          <mo>=</mo>\n          <mfrac>\n            <mn>32</mn>\n            <mn>38</mn>\n          </mfrac>\n          <mo>&#x2248;</mo>\n          <mn>0.84</mn>\n        </math>\n        </td>\n    </tr>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle\">\n        2\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        2\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        5\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        32\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        <math>\n          <mfrac>\n            <mn>27</mn>\n            <mn>32</mn>\n          </mfrac>\n        </math>\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        <math>\n          <mfrac>\n            <mn>27</mn>\n            <mn>32</mn>\n          </mfrac>\n          <mo>&#xD7;</mo>\n          <mfrac>\n            <mn>32</mn>\n            <mn>38</mn>\n          </mfrac>\n          <mo>=</mo>\n          <mfrac>\n            <mn>27</mn>\n            <mn>38</mn>\n          </mfrac>\n          <mo>&#x2248;</mo>\n          <mn>0.71</mn>\n        </math>\n        </td>\n    </tr>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle\">\n        3\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        3\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        3\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        26\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        <math>\n          <mfrac>\n            <mn>23</mn>\n            <mn>26</mn>\n          </mfrac>\n        </math>\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        <math>\n          <mfrac>\n            <mn>23</mn>\n            <mn>26</mn>\n          </mfrac>\n          <mo>&#xD7;</mo>\n          <mfrac>\n            <mn>27</mn>\n            <mn>38</mn>\n          </mfrac>\n          <mo>=</mo>\n          <mfrac>\n            <mn>621</mn>\n            <mn>988</mn>\n          </mfrac>\n          <mo>&#x2248;</mo>\n          <mn>0.63</mn>\n        </math>\n        </td>\n    </tr>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle\">\n        4\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        4\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        3\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        22\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        <math>\n          <mfrac>\n            <mn>19</mn>\n            <mn>22</mn>\n          </mfrac>\n        </math>\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        <math>\n          <mfrac>\n            <mn>19</mn>\n            <mn>22</mn>\n          </mfrac>\n          <mo>&#xD7;</mo>\n          <mfrac>\n            <mn>621</mn>\n            <mn>988</mn>\n          </mfrac>\n          <mo>=</mo>\n          <mfrac>\n            <mn>621</mn>\n            <mn>1144</mn>\n          </mfrac>\n          <mo>&#x2248;</mo>\n          <mn>0.54</mn>\n        </math>\n        </td>\n    </tr>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle\">\n        5\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        6\n        <td style=\"text-align: center; vertical-align: middle\">\n        2\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        18\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        <math>\n          <mfrac>\n            <mn>16</mn>\n            <mn>18</mn>\n          </mfrac>\n        </math>\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        <math>\n          <mfrac>\n            <mn>16</mn>\n            <mn>18</mn>\n          </mfrac>\n          <mo>&#xD7;</mo>\n          <mfrac>\n            <mn>621</mn>\n            <mn>1144</mn>\n          </mfrac>\n          <mo>=</mo>\n          <mfrac>\n            <mn>69</mn>\n            <mn>143</mn>\n          </mfrac>\n          <mo>&#x2248;</mo>\n          <mn>0.48</mn>\n        </math>\n        </td>\n    </tr>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle\">\n        6\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        7\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        0\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        16\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        <math>\n          <mn>1</mn>\n        </math>\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        <math>\n          <mn>1</mn>\n          <mo>&#xD7;</mo>\n          <mfrac>\n            <mn>69</mn>\n            <mn>143</mn>\n          </mfrac>\n          <mo>=</mo>\n          <mfrac>\n            <mn>69</mn>\n            <mn>143</mn>\n          </mfrac>\n          <mo>&#x2248;</mo>\n          <mn>0.48</mn>\n        </math>\n        </td>\n    </tr>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle\">\n        7\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        8\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        0\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        14\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        <math>\n          <mn>1</mn>\n        </math>\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        <math>\n          <mn>1</mn>\n          <mo>&#xD7;</mo>\n          <mfrac>\n            <mn>69</mn>\n            <mn>143</mn>\n          </mfrac>\n          <mo>=</mo>\n          <mfrac>\n            <mn>69</mn>\n            <mn>143</mn>\n          </mfrac>\n          <mo>&#x2248;</mo>\n          <mn>0.48</mn>\n        </math>\n        </td>\n    </tr>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle\">\n        8\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        9\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        3\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        12\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        <math>\n          <mfrac>\n            <mn>9</mn>\n            <mn>12</mn>\n          </mfrac>\n        </math>\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        <math>\n          <mfrac>\n            <mn>9</mn>\n            <mn>12</mn>\n          </mfrac>\n          <mo>&#xD7;</mo>\n          <mfrac>\n            <mn>69</mn>\n            <mn>143</mn>\n          </mfrac>\n          <mo>=</mo>\n          <mfrac>\n            <mn>207</mn>\n            <mn>572</mn>\n          </mfrac>\n          <mo>&#x2248;</mo>\n          <mn>0.36</mn>\n        </math>\n        </td>\n    </tr>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle\">\n        9\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        10\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        1\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        6\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        <math>\n          <mfrac>\n            <mn>5</mn>\n            <mn>6</mn>\n          </mfrac>\n        </math>\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        <math>\n          <mfrac>\n            <mn>5</mn>\n            <mn>6</mn>\n          </mfrac>\n          <mo>&#xD7;</mo>\n          <mfrac>\n            <mn>207</mn>\n            <mn>572</mn>\n          </mfrac>\n          <mo>=</mo>\n          <mfrac>\n            <mn>345</mn>\n            <mn>1144</mn>\n          </mfrac>\n          <mo>&#x2248;</mo>\n          <mn>0.30</mn>\n        </math>\n        </td>\n    </tr>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle\">\n        10\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        11\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        0\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        5\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        <math>\n          <mn>1</mn>\n        </math>\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        <math>\n          <mn>1</mn>\n          <mo>&#xD7;</mo>\n          <mfrac>\n            <mn>345</mn>\n            <mn>1144</mn>\n          </mfrac>\n          <mo>=</mo>\n          <mfrac>\n            <mn>345</mn>\n            <mn>1144</mn>\n          </mfrac>\n          <mo>&#x2248;</mo>\n          <mn>0.30</mn>\n        </math>\n        </td>\n    </tr>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle\">\n        11\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        13\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        1\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        4\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        <math>\n          <mfrac>\n            <mn>3</mn>\n            <mn>4</mn>\n          </mfrac>\n        </math>\n        <td style=\"text-align: center; vertical-align: middle\">\n        <math>\n          <mfrac>\n            <mn>3</mn>\n            <mn>4</mn>\n          </mfrac>\n          <mo>&#xD7;</mo>\n          <mfrac>\n            <mn>345</mn>\n            <mn>1144</mn>\n          </mfrac>\n          <mo>=</mo>\n          <mfrac>\n            <mn>1035</mn>\n            <mn>4576</mn>\n          </mfrac>\n          <mo>&#x2248;</mo>\n          <mn>0.23</mn>\n        </math>\n        </td>\n    </tr>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle\">\n        12\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        16\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        1\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        3\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        <math>\n          <mfrac>\n            <mn>2</mn>\n            <mn>3</mn>\n          </mfrac>\n        </math>\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        <math>\n          <mfrac>\n            <mn>2</mn>\n            <mn>3</mn>\n          </mfrac>\n          <mo>&#xD7;</mo>\n          <mfrac>\n            <mn>1035</mn>\n            <mn>4576</mn>\n          </mfrac>\n          <mo>=</mo>\n          <mfrac>\n            <mn>345</mn>\n            <mn>2288</mn>\n          </mfrac>\n          <mo>&#x2248;</mo>\n          <mn>0.15</mn>\n        </math>\n        </td>\n    </tr>\n    <tr>\n        <td style=\"text-align: center; vertical-align: middle\">\n        13\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        24\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        0\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        2\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        <math>\n          <mn>1</mn>\n        </math>\n        </td>\n        <td style=\"text-align: center; vertical-align: middle\">\n        <math>\n          <mn>1</mn>\n          <mo>&#xD7;</mo>\n          <mfrac>\n            <mn>345</mn>\n            <mn>2288</mn>\n          </mfrac>\n          <mo>=</mo>\n          <mfrac>\n            <mn>345</mn>\n            <mn>2288</mn>\n          </mfrac>\n          <mo>&#x2248;</mo>\n          <mn>0.15</mn>\n        </math>\n        </td>\n    </tr>\n</table>\n</div>\n```\n\n\n\nWe can now plot our estimate for $\\mathbb{P}(T>t)$ as a stepwise function of $t$. As is conventional when plotting Kaplan-Meier curves we also mark the months in which censoring occurs.\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Plotting the Estimated Survival Function in R\"}\npar(mar=c(bottom=4.2, left=5.1, top=1.8, right=0.9), family=\"Roboto Slab\") # setting the plot options\nKM_curve_plot <- function (surv_df, study_df) { # creating a function to plot a survival curve from the \n                                                # original data frame and our survival analysis data frame\n  plot(surv_df$months, surv_df$survival, type=\"s\", ylim=c(0,1), \n       xlab=\"Months\", ylab=\"Estimated Survival Function\", col=\"#009ed8\", lwd=4.8, cex.lab=1.8, cex.axis=1.8)\n  censoring_months <- sort(unique(study_df[which((study_df$event == 'Censored')),]$months))  # finding the months in which censoring occurred\n  surv_fuc_eval_at_censoring <- surv_df[surv_df$months %in% censoring_months,]$survival # evaluating the estimated survival function\n                                                                                        # at those points\n  points(censoring_months, surv_fuc_eval_at_censoring, pch=4, cex=1.8, col=\"#006a90\", lwd=4.8)\n}\nKM_curve_plot(conception_survival_analysis, conception_study)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/survival-function-plot-1.png){width=1152}\n:::\n:::\n\n\n\nOur estimated survival function allows us to work out a principled estimate for the median time to conception after laparoscopy and hydrotubation. Since the median time it takes to conceive, $t_m$, is equal to the point where $\\mathbb{P}(T>t_m)=0.5$, we can just draw a line across from 0.5 on the y-axis to our Kaplan-Meier curve. \n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Finding the Median Time to Conception in R\"}\nmedian_month <- conception_survival_analysis$months[which(conception_survival_analysis$survival <= 0.5)[1]] # finding the first month at which the estimated survival function drops to equal or below 0.5\npar(mar=c(bottom=4.2, left=5.1, top=1.8, right=0.9), family=\"Roboto Slab\") # setting the plot options\nKM_curve_plot(conception_survival_analysis, conception_study)\nsegments(-1, 0.5, median_month, 0.5, col=\"#ffc000\", lwd=4.8, lty=2) # plotting the line across from the y-axis to the survival curve\naxis(1, at=median_month, cex.lab=1.8, cex.axis=1.8) # marking 0.5 on the y-axis\nsegments(median_month, -1, median_month, 0.5, col=\"#ffc000\", lwd=4.8, lty=2) # plotting the line down from the survival curve to the x-axis\naxis(2, at=0.5, cex.lab=1.8, cex.axis=1.8) # marking the median on the x-axis\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/median-time-to-conception-1.png){width=1152}\n:::\n:::\n\n\n\nWe find that the median number of months that passed before women conceived after laparoscopy and hydrotubation was six. So, based on the results of this study, we would expect a woman with the same type of fertility problems as the study participants to have a 50% chance of conceiving within the first six months following laparoscopy and hydrotubation.\n\n## Further Reading\n\n-   [**What is the Kaplan Meier curve?** -- a blog post by Steve Simon](http://new.pmean.com/what-is-kaplan-meier-curve/)\n-   [**What is survival analysis?** -- a blog post by Antoine Soetewey](https://statsandr.com/blog/what-is-survival-analysis/)\n\n[^1]: Emily Zabor, [Survival Analysis in R,](https://www.emilyzabor.com/tutorials/survival_analysis_in_r_tutorial.html) June 21, 2023.\n[^2]: Douglas Altman and Martin Bland, [Time to event (survival) data,](https://doi.org/10.1136/bmj.317.7156.468) *BMJ* 317, no. 7156 (August 1998): 468--469.\n[^3]: Vimal Chadha et al., [Tenckhoff catheters prove superior to cook catheters in pediatric acute peritoneal dialysis,](https://doi.org/10.1016/s0272-6386(00)70048-5) *American Journal of Kidney Diseases* 35, no. 6 (June 2000): 111--1116.\n[^4]: Edward Kaplan and Paul Meier, [Nonparametric Estimation From Incomplete Observations,](https://doi.org/10.2307/2281868) *Journal of the American Statistical Association* 53, no. 282 (June 1958): 457--481.\n[^5]: Richard Van Noorden, Brendan Maher, and Regina Nuzzo, [The Top 100 Papers,]( https://doi.org/10.1038/514550a) *Nature* 514, no. 7524 (October 2014): 550--553.\n[^6]: Paramjit Luthra, Martin Bland, and Stuart Stanton, [Incidence of Pregnancy After Laparoscopy and Hydrotubation,](https://doi.org/10.1136/bmj.284.6321.1013) *British Medical Journal (Clinical Research Edition)* 284, no. 6321 (April, 1982): 101.\n[^7]: Martin Bland and Douglas Altman, [Survival probabilities (the Kaplan-Meier method),]( https://doi.org/10.1136/bmj.317.7172.1572) *BMJ* 317, no. 7172 (December 1998): 1572.",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}